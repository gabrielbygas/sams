{% extends 'base.html' %}
{% load static %}


{% block title %}
  <title>SAMS - Student Home</title>
{% endblock %}


{% block breadcrumb %}
  <ol class="breadcrumb">
    <li class="breadcrumb-item">
        <i class="bi bi-house"></i>
        <a href="{% url 'home' %}">Home</a>
    </li>
    <li class="breadcrumb-item"><a href="{% url 'receptionists:home' %}">Receptionist</a></li>
    <li class="breadcrumb-item breadcrumb-active" aria-current="page"><a href="{% url 'receptionists:list-announcement' %}">Announcements List</a></li>
  </ol>
{% endblock %}


{% block content %}
<!-- Content wrapper start -->
<div class="content-wrapper">

  <!-- Row start -->
  <div class="row">
    <!-- Card start -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">Announcement List</div>
        <div class="text-right"> <!-- Utilisez la classe "text-center" pour centrer le contenu -->
            <a href="{% url 'receptionists:create-announcement' %}"><span class="badge bg-success"><i class="bi bi-pen-fill"></i> Create List</span></a>
        </div>
      </div>
      <div class="card-body"> <br/>
        <!-- Error messages -->
        {% if messages %}
        <div class="alert alert-dismissible fade show" role="alert" id="auto-close-alert">
          <ul>
            {% for message in messages %}
              {% if message.tags == 'error' %}
                  <div class="alert alert-danger">
                      <li>{{ message }}</li>
                  </div>
              {% elif message.tags == 'success' %}
                  <div class="alert alert-success">
                      <li>{{ message }}</li>
                  </div>
              {% endif %}
            {% endfor %}
          </ul>
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% endif %}
        <!-- Error messages -->
        
        <div class="table-responsive">
          <table id="appointmentTable" class="table table-bordered table-hover table-striped display nowrap" style="width:100%">
            <thead>
              <tr>
                <th data-priority="1">Date</th>
                <th data-priority="2">Subject</th>
                <th>Message</th>
                <th>Posted By</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <!-- Card end -->
  </div>
  <!-- Row end -->

</div>
<!-- Content wrapper end -->
{% endblock %}

{% block custom-javascript %}
<script>
  // alert setTimeout
  $(document).ready(function(){
    setTimeout(function() {
      $("#auto-close-alert").alert('close');
    }, 5000);

    $('#appointmentTable').DataTable({
      "ajax": {
        "url": "{% url 'receptionists:list-announcement' %}",
        "dataSrc": ""
      },
      "columns": [
        { "data": "date_announcement" },
        { "data": "subject", "defaultContent": "" },
        { "data": "message", "defaultContent": "" },
        {
          "data": null,
          "defaultContent": "",
          "render": function (data, type, row) {
              return row.posted_by__user__first_name + " " + row.posted_by__user__last_name;
          }
        },
        {
          "data": null,
          "defaultContent": "",
          "render": function (data, type, row) {
            return  '<a href="/receptionists/announcement/view/' + row.id + '/"><span class="badge bg-primary"><i class="bi bi-eye"></i></span></a>' +
                    '<a href="/receptionists/announcement/update/' + row.id + '/"><span class="badge bg-success"><i class="bi bi-pencil"></i></span></a>' +
                    '<a href="/receptionists/announcement/delete/' + row.id + '/"><span class="badge bg-danger"><i class="bi bi-trash-fill"></i></span></a>' ;
          }
        }
      ],
      "searching": true,
      "responsive": true,
      dom: 'Bfrtip',
      buttons: [
        'copy',
        'excel',
        'csv',
        'pdf',
        'print'
      ],
    });
  });
</script>
{% endblock %}